Google Sheets & Service Account Setup Guide
This guide walks you through setting up Google Sheets API access and creating a service account for the Timeline to Logbook converter.

Table of Contents
Create a Google Cloud Project
Enable Required APIs
Create a Service Account
Get Your Google Maps API Key
Create and Share Your Google Sheet
Configure the Script
1. Create a Google Cloud Project
Go to Google Cloud Console
Sign in with your Google account
Click Select a project dropdown at the top
Click NEW PROJECT
Enter a project name (e.g., "Timeline Logbook Converter")
Click CREATE
Wait for the project to be created (you'll see a notification)
Make sure your new project is selected in the dropdown
2. Enable Required APIs
Enable Google Sheets API
In the Google Cloud Console, go to APIs & Services > Library
Or visit: https://console.cloud.google.com/apis/library
Search for "Google Sheets API"
Click on Google Sheets API
Click ENABLE
Wait for it to enable (takes a few seconds)
Enable Google Maps Geocoding API
Still in APIs & Services > Library
Search for "Geocoding API"
Click on Geocoding API
Click ENABLE
3. Create a Service Account
3.1 Create the Service Account
Go to APIs & Services > Credentials
Or visit: https://console.cloud.google.com/apis/credentials
Click + CREATE CREDENTIALS at the top
Select Service account
Fill in the details:
Service account name: timeline-converter (or any name you prefer)
Service account ID: Will auto-fill (e.g., timeline-converter@your-project.iam.gserviceaccount.com)
Description: "Service account for Timeline to Logbook converter" (optional)
Click CREATE AND CONTINUE
For "Grant this service account access to project":
Skip this (click CONTINUE)
For "Grant users access to this service account":
Skip this (click DONE)
3.2 Create and Download the JSON Key
You'll see your service account listed under Service Accounts
Click on the service account you just created
Go to the KEYS tab
Click ADD KEY > Create new key
Select JSON format
Click CREATE
A JSON file will automatically download to your computer
IMPORTANT: Rename this file to credentials.json and move it to your project directory
âš ï¸ Keep this file secure! Never share it or commit it to public repositories
3.3 Copy Your Service Account Email
On the service account details page, you'll see the email address
It looks like: timeline-converter@your-project-id.iam.gserviceaccount.com
Copy this email address - you'll need it to share your Google Sheet
4. Get Your Google Maps API Key
4.1 Create an API Key
Go to APIs & Services > Credentials
Click + CREATE CREDENTIALS
Select API key
A popup will show your new API key
Click COPY to copy the key
Click RESTRICT KEY (recommended for security)
4.2 Restrict the API Key (Recommended)
Under API restrictions:
Select Restrict key
Check only: Geocoding API
Under Application restrictions (optional but recommended):
Select IP addresses
Add your computer's IP address
Click SAVE
4.3 Enable Billing (Required for Geocoding API)
âš ï¸ The Geocoding API requires a billing account, but includes $200 free credit per month.

Go to Billing in the Google Cloud Console
Click LINK A BILLING ACCOUNT or CREATE BILLING ACCOUNT
Follow the steps to add a payment method
Note: You get $200 free credit/month, which covers ~40,000 geocoding requests
Cost Estimate: - Geocoding API: $5 per 1,000 requests - Typical usage: 100-500 unique locations = $0.50-$2.50 - Your $200 monthly credit easily covers this

5. Create and Share Your Google Sheet
5.1 Create a New Google Sheet
Go to Google Sheets
Click + Blank to create a new spreadsheet
Name your spreadsheet (e.g., "Vehicle Logbook 2024")
Create three tabs (sheets) at the bottom:
Timeline Data - Where raw imported data goes
Final Report - Where the processed logbook will appear
Backup (optional) - For keeping a copy of original data
5.2 Get Your Google Sheet ID
The Sheet ID is in the URL when you open your sheet:

https://docs.google.com/spreadsheets/d/1AbC2DeF3GhI4JkL5MnO6PqR7StU8VwX9YzA/edit
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              This is your Sheet ID
Copy this ID - you'll need it for the script configuration.

5.3 Share the Sheet with Your Service Account
ðŸ”¥ CRITICAL STEP - The script cannot access your sheet without this!

Click the Share button (top right of your Google Sheet)
In the "Add people and groups" field, paste your service account email: timeline-converter@your-project-id.iam.gserviceaccount.com
Change permission from "Viewer" to Editor
Uncheck "Notify people" (the service account won't receive emails)
Click Share or Done
âœ… You should see the service account email listed with "Editor" access

6. Configure the Script
Open timeline_complete_pipeline.py (or timeline_complete_public.py) and update these values:

# Google API Credentials
GOOGLE_MAPS_API_KEY = "AIzaSyAbc123YourActualAPIKeyHere"  # From step 4
SHEETS_CREDENTIALS_PATH = "credentials.json"  # Downloaded in step 3
SPREADSHEET_ID = "1AbC2DeF3GhI4JkL5MnO6PqR7StU8VwX9YzA"  # From step 5.2
SERVICE_ACCOUNT_EMAIL = "timeline-converter@your-project-id.iam.gserviceaccount.com"  # From step 3.3
Verification Checklist
Before running the script, verify:

[ ] Google Sheets API is enabled in your Google Cloud project
[ ] Geocoding API is enabled in your Google Cloud project
[ ] You have a credentials.json file in your project directory
[ ] Your Google Sheet has been shared with the service account email as "Editor"
[ ] You've copied your Google Maps API key into the script
[ ] You've copied your Google Sheet ID into the script
[ ] You have a billing account linked (for Geocoding API)
Testing Your Setup
Run this simple test to verify everything works:

python test_connection.py
If the test script isn't available, try running the main script:

python timeline_complete_pipeline.py
Expected Success Output:
âœ… Credentials loaded successfully
âœ… API service initialized
âœ… Successfully connected to spreadsheet!
Common Errors:
"403 Forbidden" - âŒ You didn't share the Google Sheet with the service account email - âœ… Solution: Follow step 5.3 again

"API key not valid" - âŒ Your Google Maps API key is incorrect or restricted - âœ… Solution: Check step 4 and verify the key

"Geocoding API has not been used in project" - âŒ Geocoding API isn't enabled or billing isn't set up - âœ… Solution: Follow step 2 and enable billing in step 4.3

"Unable to parse range" - âŒ Sheet tab names don't match what the script expects - âœ… Solution: Create tabs named "Timeline Data" and "Final Report"

Security Best Practices
Protecting Your Credentials
Never commit credentials.json to git

Add to .gitignore: credentials.json *.json
Never share your API keys publicly

Don't post them in forums, GitHub issues, etc.
Restrict your API key

Follow step 4.2 to limit what the key can do
Revoke and regenerate if exposed

If you accidentally expose credentials:
Delete the service account key in Google Cloud Console
Create a new key
Regenerate your API key
Minimal Permissions
The service account only needs: - Read/write access to your specific Google Sheet - No other Google Drive or project permissions are needed

Troubleshooting
"Error loading credentials.json"
Problem: File not found or incorrectly formatted

Solutions: 1. Verify the file is named exactly credentials.json 2. Check it's in the same directory as your script 3. Open the file - it should be valid JSON starting with { 4. Re-download from Google Cloud Console if corrupted

"Sheet not found" or "Unable to read sheet"
Problem: Script can't access your Google Sheet

Solutions: 1. Verify the Sheet ID is correct (copy from URL) 2. Confirm you shared the sheet with the service account 3. Check the service account has "Editor" (not "Viewer") permission 4. Make sure tab names match: "Timeline Data" and "Final Report"

"Geocoding API error" or "OVER_QUERY_LIMIT"
Problem: API quota or billing issues

Solutions: 1. Check billing is enabled in Google Cloud Console 2. Verify Geocoding API is enabled 3. Check you haven't exceeded your quota (unlikely with $200 credit) 4. Wait a few minutes and try again

"Invalid value at 'requests'"
Problem: Data format issue when writing to sheet

Solutions: 1. Ensure your Timeline Data has proper headers in row 1 2. Check dates are in format: YYYY-MM-DD HH:MM:SS 3. Verify no cells have special characters that break formatting

Cost Management
Monitoring Your Usage
Go to Google Cloud Console > Billing > Reports
Filter by:
Service: Geocoding API
Time range: Current month
You'll see your usage and costs
Staying Within Free Tier
$200 free credit per month = ~40,000 geocoding requests
Typical usage: 100-5,000 requests per run
The script uses caching to minimize repeat requests
You're very unlikely to exceed the free tier
Setting Up Budget Alerts (Optional)
Go to Billing > Budgets & alerts
Click CREATE BUDGET
Set budget amount (e.g., $10)
Set alert thresholds (e.g., 50%, 90%, 100%)
Add your email to receive alerts
Additional Resources
Google Cloud Console
Google Sheets API Documentation
Geocoding API Documentation
Service Account Documentation
Summary
You now have: 1. âœ… A Google Cloud Project with required APIs enabled 2. âœ… A service account with JSON credentials 3. âœ… A Google Maps API key for geocoding 4. âœ… A Google Sheet shared with your service account 5. âœ… A properly configured script ready to run

Next Step: Run your script and start converting your Timeline data to a CRA-compliant logbook!

python timeline_complete_pipeline.py
